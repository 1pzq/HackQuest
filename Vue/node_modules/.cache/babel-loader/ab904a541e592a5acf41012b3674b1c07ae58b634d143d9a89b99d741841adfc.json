{"ast":null,"code":"import { createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, vModelText as _vModelText, withDirectives as _withDirectives, createCommentVNode as _createCommentVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nvar _hoisted_1 = {\n  \"class\": \"box1\"\n};\nvar _hoisted_2 = {\n  \"class\": \"host\"\n};\nvar _hoisted_3 = {\n  \"class\": \"label\"\n};\nvar _hoisted_4 = {\n  \"class\": \"address\"\n};\nvar _hoisted_5 = {\n  \"class\": \"label\"\n};\nvar _hoisted_6 = {\n  \"class\": \"btn\"\n};\nvar _hoisted_7 = {\n  \"class\": \"label\"\n};\nvar _hoisted_8 = {\n  \"class\": \"btn\"\n};\nvar _hoisted_9 = {\n  \"class\": \"label\"\n};\nvar _hoisted_10 = {\n  \"class\": \"btn\"\n};\nvar _hoisted_11 = {\n  \"class\": \"vote-time\"\n};\nvar _hoisted_12 = {\n  \"class\": \"btn\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_van_divider = _resolveComponent(\"van-divider\");\n  var _component_van_icon = _resolveComponent(\"van-icon\");\n  var _component_van_space = _resolveComponent(\"van-space\");\n  var _component_van_button = _resolveComponent(\"van-button\");\n  var _component_van_field = _resolveComponent(\"van-field\");\n  var _component_van_cell_group = _resolveComponent(\"van-cell-group\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_van_divider, null, {\n    \"default\": _withCtx(function () {\n      return [_createTextVNode(\"分发票权\")];\n    }),\n    _: 1 /* STABLE */\n  }), _createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_van_space, null, {\n    \"default\": _withCtx(function () {\n      return [_createElementVNode(\"p\", _hoisted_3, [_createVNode(_component_van_icon, {\n        name: \"manager\"\n      }), _createTextVNode(\"主持人地址\")]), _createElementVNode(\"p\", _hoisted_4, _toDisplayString($setup.host), 1 /* TEXT */)];\n    }),\n\n    _: 1 /* STABLE */\n  })]), _createElementVNode(\"div\", null, [_createVNode(_component_van_space, null, {\n    \"default\": _withCtx(function () {\n      return [_createElementVNode(\"p\", _hoisted_5, [_createVNode(_component_van_icon, {\n        name: \"friends-o\"\n      }), _createTextVNode(\"投票人地址\")]), _withDirectives(_createElementVNode(\"textarea\", {\n        \"class\": \"votors\",\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n          return $setup.voterAddress = $event;\n        })\n      }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.voterAddress]])];\n    }),\n    _: 1 /* STABLE */\n  })]), _createElementVNode(\"div\", _hoisted_6, [_createVNode(_component_van_button, {\n    block: \"\",\n    onClick: $setup.mandate\n  }, {\n    \"default\": _withCtx(function () {\n      return [_createTextVNode(\"开始分发选票\")];\n    }),\n    _: 1 /* STABLE */\n  })]), _createElementVNode(\"div\", null, [_createVNode(_component_van_space, null, {\n    \"default\": _withCtx(function () {\n      return [_createElementVNode(\"p\", _hoisted_7, [_createVNode(_component_van_icon, {\n        name: \"friends-1\"\n      }), _createTextVNode(\"去除投票人\")]), _withDirectives(_createElementVNode(\"textarea\", {\n        \"class\": \"votors\",\n        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = function ($event) {\n          return $setup.removeTheAccount = $event;\n        })\n      }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.removeTheAccount]])];\n    }),\n    _: 1 /* STABLE */\n  })]), _createElementVNode(\"div\", _hoisted_8, [_createVNode(_component_van_button, {\n    block: \"\",\n    onClick: $setup.removeAccount\n  }, {\n    \"default\": _withCtx(function () {\n      return [_createTextVNode(\"去除投票人\")];\n    }),\n    _: 1 /* STABLE */\n  })]), _createElementVNode(\"div\", null, [_createVNode(_component_van_space, null, {\n    \"default\": _withCtx(function () {\n      return [_createElementVNode(\"p\", _hoisted_9, [_createVNode(_component_van_icon, {\n        name: \"friends-o\"\n      }), _createTextVNode(\"初始化投票时间\")]), _withDirectives(_createElementVNode(\"textarea\", {\n        \"class\": \"votors\",\n        \"onUpdate:modelValue\": _cache[2] || (_cache[2] = function ($event) {\n          return $setup.initVoteTime = $event;\n        })\n      }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.initVoteTime]])];\n    }),\n    _: 1 /* STABLE */\n  })]), _createElementVNode(\"div\", _hoisted_10, [_createVNode(_component_van_button, {\n    block: \"\",\n    onClick: $setup.startVoting\n  }, {\n    \"default\": _withCtx(function () {\n      return [_createTextVNode(\"开始选票\")];\n    }),\n    _: 1 /* STABLE */\n  })]), _createElementVNode(\"div\", _hoisted_11, [_createElementVNode(\"p\", null, \"剩余投票时间: \" + _toDisplayString($setup.formatTime($setup.voteTime)), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_12, [_createVNode(_component_van_button, {\n    block: \"\",\n    onClick: $setup.endVoting\n  }, {\n    \"default\": _withCtx(function () {\n      return [_createTextVNode(\"结束选票\")];\n    }),\n    _: 1 /* STABLE */\n  })]), _createVNode(_component_van_cell_group, {\n    inset: \"\"\n  }, {\n    \"default\": _withCtx(function () {\n      return [_createCommentVNode(\" 输入任意文本 \"), _createVNode(_component_van_field, {\n        modelValue: _ctx.text,\n        \"onUpdate:modelValue\": _cache[3] || (_cache[3] = function ($event) {\n          return _ctx.text = $event;\n        }),\n        label: \"文本\"\n      }, null, 8 /* PROPS */, [\"modelValue\"]), _createCommentVNode(\" 输入手机号，调起手机号键盘 \"), _createVNode(_component_van_field, {\n        modelValue: _ctx.tel,\n        \"onUpdate:modelValue\": _cache[4] || (_cache[4] = function ($event) {\n          return _ctx.tel = $event;\n        }),\n        type: \"tel\",\n        label: \"手机号\"\n      }, null, 8 /* PROPS */, [\"modelValue\"]), _createCommentVNode(\" 允许输入正整数，调起纯数字键盘 \"), _createVNode(_component_van_field, {\n        modelValue: _ctx.digit,\n        \"onUpdate:modelValue\": _cache[5] || (_cache[5] = function ($event) {\n          return _ctx.digit = $event;\n        }),\n        type: \"digit\",\n        label: \"整数\"\n      }, null, 8 /* PROPS */, [\"modelValue\"]), _createCommentVNode(\" 允许输入数字，调起带符号的纯数字键盘 \"), _createVNode(_component_van_field, {\n        modelValue: _ctx.number,\n        \"onUpdate:modelValue\": _cache[6] || (_cache[6] = function ($event) {\n          return _ctx.number = $event;\n        }),\n        type: \"number\",\n        label: \"数字\"\n      }, null, 8 /* PROPS */, [\"modelValue\"]), _createCommentVNode(\" 输入密码 \"), _createVNode(_component_van_field, {\n        modelValue: _ctx.password,\n        \"onUpdate:modelValue\": _cache[7] || (_cache[7] = function ($event) {\n          return _ctx.password = $event;\n        }),\n        type: \"password\",\n        label: \"密码\"\n      }, null, 8 /* PROPS */, [\"modelValue\"])];\n    }),\n    _: 1 /* STABLE */\n  })]);\n}","map":{"version":3,"mappings":"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","names":["_createElementBlock","_hoisted_1","_createVNode","_component_van_divider","_createElementVNode","_hoisted_2","_component_van_space","_hoisted_3","_component_van_icon","name","_hoisted_4","$setup","_hoisted_5","_hoisted_6","_component_van_button","block","onClick","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_component_van_cell_group","inset","_createCommentVNode","_component_van_field","_ctx","label","type"],"sourceRoot":"","sources":["/Users/puzhiqiu/工程项目/HackQuest/HackQuest/vue/src/views/MandateView.vue"],"sourcesContent":["<script setup>\nimport useWeb3 from \"../hooks/useWeb3\";\nimport { ref, onMounted } from \"vue\";\nconst { web3, voteContract, getAccount } = useWeb3();\n\n// 定义主持人信息\nconst host = ref(\"\");\n\nconst account = ref(\"\");\n\n// 获取主持人信息\nconst getHost = async () => {\n  host.value = await voteContract.methods.host().call();\n};\n\n// 选民地址\nconst voterAddress = ref(\"\");\n//去除投票人\nconst removeTheAccount = ref(\"\");\n//投票时间\nconst voteTime = ref(\"0\");\n// 初始化投票时间\nconst initVoteTime = ref(\"0\");\n//结束选票\nconst endVoting = async () => {\n  const account = await getAccount();\n  voteContract.methods\n    .endVoting()\n    .send({ from: account })\n    .on(\"receipt\", () => {\n      console.log(\"结束投票成功\");\n    });\n};\n\n// 分发票权\nconst mandate = async () => {\n  const arr = eval(voterAddress.value);\n  const account = await getAccount();\n  voteContract.methods\n    .mandate(arr)\n    .send({ from: account })\n    .on(\"receipt\", () => {\n      console.log(\"选票分发成功\");\n    });\n};\n// 开始投票\nconst startVoting = async () => {\n  const account = await getAccount();\n  voteContract.methods\n    .startVoting(initVoteTime.value) // 假设投票选项为 0\n    .send({ from: account })\n    .on(\"receipt\", () => {\n      console.log(\"投票成功\");\n    });\n};\n//去除投票人\nconst removeAccount = async () => {\n  const arr = eval(removeTheAccount.value);\n  const account = await getAccount();\n  voteContract.methods\n    .removeVoter(arr) // 假设投票选项为 0\n    .send({ from: account })\n    .on(\"receipt\", () => {\n      console.log(\"投票成功\");\n    });\n};\n//获取合约剩余时间\nconst getVoteTime = async () => {\n  voteTime.value = await voteContract.methods.leftTime().call();\n};\n\n// 转换秒数为时分秒格式\nconst formatTime = (seconds) => {\n  const hrs = Math.floor(seconds / 3600);\n  const mins = Math.floor((seconds % 3600) / 60);\n  const secs = seconds % 60;\n  return `${hrs.toString().padStart(2, \"0\")}:${mins\n    .toString()\n    .padStart(2, \"0\")}:${secs.toString().padStart(2, \"0\")}`;\n};\n\nonMounted(async () => {\n  await getHost();\n  await getVoteTime();\n  setInterval(async () => {\n    await getVoteTime();\n  }, 1000); // 每秒更新一次\n});\n</script>\n\n<template>\n  <div class=\"box1\">\n    <van-divider>分发票权</van-divider>\n    <div class=\"host\">\n      <van-space>\n        <p class=\"label\"><van-icon name=\"manager\" />主持人地址</p>\n        <p class=\"address\">{{ host }}</p>\n      </van-space>\n    </div>\n    <div>\n      <van-space>\n        <p class=\"label\"><van-icon name=\"friends-o\" />投票人地址</p>\n        <textarea class=\"votors\" v-model=\"voterAddress\"></textarea>\n      </van-space>\n    </div>\n    <div class=\"btn\">\n      <van-button block @click=\"mandate\">开始分发选票</van-button>\n    </div>\n    <div>\n      <van-space>\n        <p class=\"label\"><van-icon name=\"friends-1\" />去除投票人</p>\n        <textarea class=\"votors\" v-model=\"removeTheAccount\"></textarea>\n      </van-space>\n    </div>\n    <div class=\"btn\">\n      <van-button block @click=\"removeAccount\">去除投票人</van-button>\n    </div>\n    <div>\n      <van-space>\n        <p class=\"label\"><van-icon name=\"friends-o\" />初始化投票时间</p>\n        <textarea class=\"votors\" v-model=\"initVoteTime\"></textarea>\n      </van-space>\n    </div>\n\n    <div class=\"btn\">\n      <van-button block @click=\"startVoting\">开始选票</van-button>\n    </div>\n    <div class=\"vote-time\">\n      <p>剩余投票时间: {{ formatTime(voteTime) }}</p>\n    </div>\n    <div class=\"btn\">\n      <van-button block @click=\"endVoting\">结束选票</van-button>\n    </div>\n    <van-cell-group inset>\n      <!-- 输入任意文本 -->\n      <van-field v-model=\"text\" label=\"文本\" />\n      <!-- 输入手机号，调起手机号键盘 -->\n      <van-field v-model=\"tel\" type=\"tel\" label=\"手机号\" />\n      <!-- 允许输入正整数，调起纯数字键盘 -->\n      <van-field v-model=\"digit\" type=\"digit\" label=\"整数\" />\n      <!-- 允许输入数字，调起带符号的纯数字键盘 -->\n      <van-field v-model=\"number\" type=\"number\" label=\"数字\" />\n      <!-- 输入密码 -->\n      <van-field v-model=\"password\" type=\"password\" label=\"密码\" />\n    </van-cell-group>\n  </div>\n</template>\n\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}