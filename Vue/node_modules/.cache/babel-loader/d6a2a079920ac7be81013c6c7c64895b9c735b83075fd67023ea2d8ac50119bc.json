{"ast":null,"code":"import \"core-js/modules/es.function.name.js\";\nimport { createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createBlock as _createBlock } from \"vue\";\nvar _hoisted_1 = {\n  \"class\": \"box3\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_van_divider = _resolveComponent(\"van-divider\");\n  var _component_van_button = _resolveComponent(\"van-button\");\n  var _component_van_cell = _resolveComponent(\"van-cell\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_van_divider, null, {\n    \"default\": _withCtx(function () {\n      return [_createTextVNode(\"投票看板\")];\n    }),\n    _: 1 /* STABLE */\n  }), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.board, function (item, index) {\n    return _openBlock(), _createBlock(_component_van_cell, {\n      title: item.name,\n      icon: \"shop-o\",\n      key: index\n    }, {\n      \"right-icon\": _withCtx(function () {\n        return [_createVNode(_component_van_button, {\n          onClick: function onClick($event) {\n            return $setup.vote(index);\n          }\n        }, {\n          \"default\": _withCtx(function () {\n            return [_createTextVNode(_toDisplayString(item.totalAmount), 1 /* TEXT */)];\n          }),\n\n          _: 2 /* DYNAMIC */\n        }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])];\n      }),\n      _: 2 /* DYNAMIC */\n    }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"title\"]);\n  }), 128 /* KEYED_FRAGMENT */))]);\n}","map":{"version":3,"mappings":";;;EA8CO,SAAM;AAAM;;;;;uBAAjBA,oBAYM,OAZNC,UAYM,GAXJC,aAA+BC;wBAAlB;MAAA,OAAI,kBAAJ,MAAI;;;yBACjBH,oBASWI,6BANeC,YAAK,YAArBC,IAAI,EAAEC,KAAK;yBAHrBC,aASWC;MARRC,KAAK,EAAEJ,IAAI,CAACK,IAAI;MACjBC,IAAI,EAAC,QAAQ;MAEZC,GAAG,EAAEN;;MAEK,YAAU,WACnB;QAAA,OAAoE,CAApEL,aAAoEY;UAAvDC,OAAK;YAAA,OAAEV,WAAI,CAACE,KAAK;UAAA;;8BAAG;YAAA,OAAsB,mCAAnBD,IAAI,CAACU,WAAW","names":["_createElementBlock","_hoisted_1","_createVNode","_component_van_divider","_Fragment","$setup","item","index","_createBlock","_component_van_cell","title","name","icon","key","_component_van_button","onClick","totalAmount"],"sourceRoot":"","sources":["/Users/puzhiqiu/工程项目/HackQuest/HackQuest/vue/src/views/BoardView.vue"],"sourcesContent":["<script setup>\nimport useWeb3 from \"@/hooks/useWeb3\";\nimport { ref, onMounted } from \"vue\";\nconst { web3, voteContract, getAccount } = useWeb3();\n\n// 看板信息\nconst board = ref([]);\n\nconst account = ref(\"\");\n\nconst getBoardInfo = async () => {\n  account.value = await getAccount();\n  board.value = await voteContract.methods.getBoardInfo().call();\n};\n\n//添加选举人\nconst addTheElected = async () => {\n  const account = await getAccount();\n  const result = await voteContract.methods\n    .addTheElected()\n    .send({ from: account });\n};\n\nconst vote = async (index) => {\n  const account = await getAccount();\n  const result = await voteContract.methods.vote(index).send({ from: account });\n};\n\nconst initEventListen = () => {\n  voteContract.events\n    .voteSuccess({ fromBlock: 0 }, (err, event) => {\n      console.log(\"监听执行\");\n      console.log(event);\n    })\n    .on(\"data\", (event) => {\n      console.log(\"智能合约触发的事件：\", event.returnValues);\n    });\n};\n\nonMounted(() => {\n  initEventListen();\n  getBoardInfo();\n});\n</script>\n\n<template>\n  <div class=\"box3\">\n    <van-divider>投票看板</van-divider>\n    <van-cell\n      :title=\"item.name\"\n      icon=\"shop-o\"\n      v-for=\"(item, index) in board\"\n      :key=\"index\"\n    >\n      <template #right-icon>\n        <van-button @click=\"vote(index)\">{{ item.totalAmount }}</van-button>\n      </template>\n    </van-cell>\n  </div>\n</template>\n\n<style lang=\"less\"></style>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}