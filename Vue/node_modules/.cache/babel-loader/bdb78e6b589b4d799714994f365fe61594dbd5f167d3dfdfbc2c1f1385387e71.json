{"ast":null,"code":"import \"core-js/modules/es.function.name.js\";\nimport { createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createBlock as _createBlock, createElementVNode as _createElementVNode, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\nvar _withScopeId = function _withScopeId(n) {\n  return _pushScopeId(\"data-v-59cf3461\"), n = n(), _popScopeId(), n;\n};\nvar _hoisted_1 = {\n  \"class\": \"scrollable-box box2\"\n};\nvar _hoisted_2 = {\n  \"class\": \"btn\"\n};\nvar _hoisted_3 = {\n  \"class\": \"btn\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  var _component_van_divider = _resolveComponent(\"van-divider\");\n  var _component_van_button = _resolveComponent(\"van-button\");\n  var _component_van_cell = _resolveComponent(\"van-cell\");\n  var _component_van_field = _resolveComponent(\"van-field\");\n  var _component_van_cell_group = _resolveComponent(\"van-cell-group\");\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createElementVNode(\"div\", _hoisted_1, [_createVNode(_component_van_divider, {\n    style: {\n      color: '#1989fa',\n      borderColor: 'red',\n      padding: '-20px 10px'\n    }\n  }, {\n    \"default\": _withCtx(function () {\n      return [_createTextVNode(\" Voting board \")];\n    }),\n    _: 1 /* STABLE */\n  }), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.board, function (item, index) {\n    return _openBlock(), _createBlock(_component_van_cell, {\n      title: item.name,\n      icon: \"shop-o\",\n      key: index\n    }, {\n      \"right-icon\": _withCtx(function () {\n        return [_createVNode(_component_van_button, {\n          onClick: function onClick($event) {\n            return $setup.vote(index);\n          }\n        }, {\n          \"default\": _withCtx(function () {\n            return [_createTextVNode(_toDisplayString(item.totalAmount), 1 /* TEXT */)];\n          }),\n\n          _: 2 /* DYNAMIC */\n        }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])];\n      }),\n      _: 2 /* DYNAMIC */\n    }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"title\"]);\n  }), 128 /* KEYED_FRAGMENT */))]), _createElementVNode(\"div\", null, [_createVNode(_component_van_cell_group, {\n    inset: \"\"\n  }, {\n    \"default\": _withCtx(function () {\n      return [_createVNode(_component_van_field, {\n        modelValue: $setup.addElected,\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = function ($event) {\n          return $setup.addElected = $event;\n        }),\n        required: \"\",\n        label: \"Addelectors\",\n        placeholder: \"请输入选举人地址\"\n      }, null, 8 /* PROPS */, [\"modelValue\"])];\n    }),\n    _: 1 /* STABLE */\n  })]), _createElementVNode(\"div\", _hoisted_2, [_createVNode(_component_van_button, {\n    round: \"\",\n    block: \"\",\n    onClick: $setup.addTheElected,\n    type: \"success\"\n  }, {\n    \"default\": _withCtx(function () {\n      return [_createTextVNode(\"AddElectors\")];\n    }),\n    _: 1 /* STABLE */\n  })]), _createVNode(_component_van_divider, {\n    style: {\n      color: '#1989fa',\n      borderColor: 'red',\n      padding: '0px 10px'\n    }\n  }), _createElementVNode(\"div\", null, [_createVNode(_component_van_cell_group, {\n    inset: \"\"\n  }, {\n    \"default\": _withCtx(function () {\n      return [_createVNode(_component_van_field, {\n        modelValue: $setup.removeElected,\n        \"onUpdate:modelValue\": _cache[1] || (_cache[1] = function ($event) {\n          return $setup.removeElected = $event;\n        }),\n        required: \"\",\n        label: \"去除选举人\",\n        placeholder: \"请输入去除的选举人\"\n      }, null, 8 /* PROPS */, [\"modelValue\"])];\n    }),\n    _: 1 /* STABLE */\n  })]), _createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_van_button, {\n    round: \"\",\n    block: \"\",\n    onClick: $setup.removeTheElected,\n    type: \"success\"\n  }, {\n    \"default\": _withCtx(function () {\n      return [_createTextVNode(\"去除选举人\")];\n    }),\n    _: 1 /* STABLE */\n  })]), _createVNode(_component_van_divider, {\n    style: {\n      color: '#1989fa',\n      borderColor: 'red',\n      padding: '0px 10px'\n    }\n  }), _createElementVNode(\"div\", null, [_createVNode(_component_van_cell, {\n    required: \"\",\n    title: \"最后的胜者\",\n    value: $setup.Winner\n  }, null, 8 /* PROPS */, [\"value\"])]), _createElementVNode(\"div\", null, [_createVNode(_component_van_button, {\n    round: \"\",\n    block: \"\",\n    onClick: $setup.getTheWinner,\n    type: \"success\"\n  }, {\n    \"default\": _withCtx(function () {\n      return [_createTextVNode(\"查看最后的Winner\")];\n    }),\n    _: 1 /* STABLE */\n  })])], 64 /* STABLE_FRAGMENT */);\n}","map":{"version":3,"mappings":";;;;;;EAwEO,SAAM;AAAqB;;EA4B3B,SAAM;AAAK;;EAoBX,SAAM;AAAK;;;;;;;6DAhDhBA,oBAiBM,OAjBNC,UAiBM,GAhBJC,aAIcC;IAHXC,KAAK,EAAE;MAAAC;MAAAC;MAAAC;IAAA;EAA+D;wBACxE;MAAA,OAED,kBAFC,gBAED;;;yBAEAC,oBASWC,6BANeC,YAAK,YAArBC,IAAI,EAAEC,KAAK;yBAHrBC,aASWC;MARRC,KAAK,EAAEJ,IAAI,CAACK,IAAI;MACjBC,IAAI,EAAC,QAAQ;MAEZC,GAAG,EAAEN;;MAEK,YAAU,WACnB;QAAA,OAAoE,CAApEV,aAAoEiB;UAAvDC,OAAK;YAAA,OAAEV,WAAI,CAACE,KAAK;UAAA;;8BAAG;YAAA,OAAsB,mCAAnBD,IAAI,CAACU,WAAW;;;;;;;;oCAI1DrB,oBASM,cARJE,aAOiBoB;IAPDC,KAAK,EAAL;EAAK;wBACnB;MAAA,OAKE,CALFrB,aAKEsB;oBAJSd,iBAAU;;iBAAVA,iBAAU;QAAA;QACnBe,QAAQ,EAAR,EAAQ;QACRC,KAAK,EAAC,aAAa;QACnBC,WAAW,EAAC;;;;QAIlB3B,oBAIM,OAJN4B,UAIM,GAHJ1B,aAECiB;IAFWU,KAAK,EAAL,EAAK;IAACC,KAAK,EAAL,EAAK;IAAEV,OAAK,EAAEV,oBAAa;IAAEqB,IAAI,EAAC;;wBACjD;MAAA,OAAW,kBAAX,aAAW;;;QAGhB7B,aAGcC;IAFXC,KAAK,EAAE;MAAAC;MAAAC;MAAAC;IAAA;EAA6D,IAGvEP,oBASM,cARJE,aAOiBoB;IAPDC,KAAK,EAAL;EAAK;wBACnB;MAAA,OAKE,CALFrB,aAKEsB;oBAJSd,oBAAa;;iBAAbA,oBAAa;QAAA;QACtBe,QAAQ,EAAR,EAAQ;QACRC,KAAK,EAAC,OAAO;QACbC,WAAW,EAAC;;;;QAKlB3B,oBAIM,OAJNgC,UAIM,GAHJ9B,aAECiB;IAFWU,KAAK,EAAL,EAAK;IAACC,KAAK,EAAL,EAAK;IAAEV,OAAK,EAAEV,uBAAgB;IAAEqB,IAAI,EAAC;;wBACpD;MAAA,OAAK,kBAAL,OAAK;;;QAGV7B,aAGcC;IAFXC,KAAK,EAAE;MAAAC;MAAAC;MAAAC;IAAA;EAA6D,IAGvEP,oBAEM,cADJE,aAA4DY;IAAlDW,QAAQ,EAAR,EAAQ;IAACV,KAAK,EAAC,OAAO;IAAEkB,KAAK,EAAEvB;wCAE3CV,oBAIM,cAHJE,aAECiB;IAFWU,KAAK,EAAL,EAAK;IAACC,KAAK,EAAL,EAAK;IAAEV,OAAK,EAAEV,mBAAY;IAAEqB,IAAI,EAAC;;wBAChD;MAAA,OAAW,kBAAX,aAAW","names":["_createElementVNode","_hoisted_1","_createVNode","_component_van_divider","style","color","borderColor","padding","_createElementBlock","_Fragment","$setup","item","index","_createBlock","_component_van_cell","title","name","icon","key","_component_van_button","onClick","totalAmount","_component_van_cell_group","inset","_component_van_field","required","label","placeholder","_hoisted_2","round","block","type","_hoisted_3","value"],"sourceRoot":"","sources":["/Users/puzhiqiu/工程项目/HackQuest/HackQuest/vue/src/views/BoardView.vue"],"sourcesContent":["<script setup>\nimport useWeb3 from \"@/hooks/useWeb3\";\nimport { ref, onMounted } from \"vue\";\nconst { web3, voteContract, getAccount } = useWeb3();\n\n// 看板信息\nconst board = ref([]);\n// 添加选举人\nconst addElected = ref([]);\n// 去除选举人\nconst removeElected = ref([]);\n// 查看最后的Winner\nconst Winner = ref([]);\n\nconst account = ref(\"\");\n\nconst getBoardInfo = async () => {\n  account.value = await getAccount();\n  board.value = await voteContract.methods.getBoardInfo().call();\n};\n\n//添加选举人\nconst addTheElected = async () => {\n  const arr = eval(addElected.value);\n  const account = await getAccount();\n  voteContract.methods\n    .addTheElected(arr)\n    .send({ from: account })\n    .on(\"receipt\", () => {\n      console.log(\"添加选举人成功\");\n    });\n};\n//去除选举人\nconst removeTheElected = async () => {\n  const arr = eval(removeElected.value);\n  const account = await getAccount();\n  voteContract.methods\n    .removeElected(arr)\n    .send({ from: account })\n    .on(\"receipt\", () => {\n      console.log(\"去除选举人成功\");\n    });\n};\n//获取最后的决胜者\nconst getTheWinner = async () => {\n  Winner.value = await voteContract.methods.getWinInfo().call();\n};\n\n//进行投票\nconst vote = async (index) => {\n  const account = await getAccount();\n  const result = await voteContract.methods.vote(index).send({ from: account });\n};\n\nconst initEventListen = () => {\n  voteContract.events\n    .voteSuccess({ fromBlock: 0 }, (err, event) => {\n      console.log(\"监听执行\");\n      console.log(event);\n    })\n    .on(\"data\", (event) => {\n      console.log(\"智能合约触发的事件：\", event.returnValues);\n    });\n};\n\nonMounted(() => {\n  initEventListen();\n  getBoardInfo();\n});\n</script>\n\n<template>\n  <div class=\"scrollable-box box2\">\n    <van-divider\n      :style=\"{ color: '#1989fa', borderColor: 'red', padding: '-20px 10px' }\"\n    >\n      Voting board\n    </van-divider>\n\n    <van-cell\n      :title=\"item.name\"\n      icon=\"shop-o\"\n      v-for=\"(item, index) in board\"\n      :key=\"index\"\n    >\n      <template #right-icon>\n        <van-button @click=\"vote(index)\">{{ item.totalAmount }}</van-button>\n      </template>\n    </van-cell>\n  </div>\n  <div>\n    <van-cell-group inset>\n      <van-field\n        v-model=\"addElected\"\n        required\n        label=\"Addelectors\"\n        placeholder=\"请输入选举人地址\"\n      />\n    </van-cell-group>\n  </div>\n  <div class=\"btn\">\n    <van-button round block @click=\"addTheElected\" type=\"success\"\n      >AddElectors</van-button\n    >\n  </div>\n  <van-divider\n    :style=\"{ color: '#1989fa', borderColor: 'red', padding: '0px 10px' }\"\n  >\n  </van-divider>\n  <div>\n    <van-cell-group inset>\n      <van-field\n        v-model=\"removeElected\"\n        required\n        label=\"去除选举人\"\n        placeholder=\"请输入去除的选举人\"\n      />\n    </van-cell-group>\n  </div>\n\n  <div class=\"btn\">\n    <van-button round block @click=\"removeTheElected\" type=\"success\"\n      >去除选举人</van-button\n    >\n  </div>\n  <van-divider\n    :style=\"{ color: '#1989fa', borderColor: 'red', padding: '0px 10px' }\"\n  >\n  </van-divider>\n  <div>\n    <van-cell required title=\"最后的胜者\" :value=\"Winner\"></van-cell>\n  </div>\n  <div>\n    <van-button round block @click=\"getTheWinner\" type=\"success\"\n      >查看最后的Winner</van-button\n    >\n  </div>\n</template>\n\n<style scoped>\n.scrollable-box {\n  max-height: 350px; /* 固定高度，适当调整 */\n  overflow-y: auto; /* 超出区域时滚动查看 */\n}\n</style>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}